Формирование клавиатуры программным способом на платформе 1С:Предприятие.

Модуль состоит из трех частей:
* Определение кнопок клавиатуры;
* Формирование кнопок;
* Возвращение кода нажатой клавиши.

Программная клавиатура содержит несколько раскладок, где каждая раскладка состоит из нескольких рядов кнопок, а кнопка определяет нажатое значение.

```
	Кнопки = Новый Массив;
	Кнопки.Добавить("й,ц,у,к,е,н,г,ш,щ,з,х,ъ");
	Кнопки.Добавить("TAB,ф,ы,в,а,п,р,о,л,д,ж,э");
	Кнопки.Добавить("SHIFT,я,ч,с,м,и,т,ь,б,ю");
	Кнопки.Добавить("LONG_TAB,SPACE");
```

Структура отображения клавиатуры:
* Страницы - перечень доступных раскладок;
* Страница - выбранная раскладка;
* Ряд кнопок;
* Кнопка.

```
Функция ДобавитьРаскладку(Знач Форма, Знач ЭлементыФормы, Знач  ДляГруппыЭлементов, Знач ПарамКлавиатуры)
	Клавиатура = ЭлементыФормы.Добавить("Страница_" + ПарамКлавиатуры.Имя, Тип("ГруппаФормы"), ДляГруппыЭлементов);
	Клавиатура.Вид = ВидГруппыФормы.Страница;
	Клавиатура.ОтображатьЗаголовок = ЛожЬ;
	
	Инд = 1;
	Для Каждого РядКнопок Из ПарамКлавиатуры.Кнопки ЦИкл
	
		КнопкаРядФормы = Элементы.Добавить("Группа" + Клавиатура.Имя + "_" + Инд, Тип("ГруппаФормы"), Клавиатура);
		КнопкаРядФормы.Вид = ВидГруппыФормы.ОбычнаяГруппа;
		КнопкаРядФормы.Группировка = ГруппировкаПодчиненныхЭлементовФормы.Горизонтальная;
		КнопкаРядФормы.ОтображатьЗаголовок = ЛожЬ;
		
		Для Каждого кнопка Из СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(РядКнопок,",") Цикл
			Если ЭтоСлужебнаяКнопка(кнопка) Тогда
				ДобавитьСлужебнуюКнопку(Форма, ЭлементыФормы, КнопкаРядФормы, кнопка);
			Иначе
				ДобавитьОбычнуюКнопку(Форма, ЭлементыФормы, КнопкаРядФормы, кнопка);
			КонецЕсли;
		КонецЦИкла;
		Инд = Инд + 1;
	КонецЦикла;
	Возврат Клавиатура;
КонецФункции
```

При добавлении групп элементов формы, необходимо заблокировать отображение заголовков и других вспомогательных полей.

```
		КнопкаРядФормы.ОтображатьЗаголовок = Ложь;
```

Перед создание кнопок, необходимо добавить команды к форме.
```
Функция ДобавитьКоманду(Знач ИмяКоманды, Знач ОбработчикНажатия)
	Команда = Форма.Команды.Добавить(ИмяКоманды);
	Команда.Действие = ОбработчикНажатия;
	Возврат Команда;
КонецФункции
```

При добавлении кнопок на форму элемента, необходимо настроить их оформление.
```
Функция ДобавитьОбычнуюКнопку(Знач ЭлементыФормы, Знач  ДляРяда, Знач Кнопка)
	КнопкаРядФормы = ЭлементыФормы.Добавить(Кнопка + "_" + ДляРяда.Имя , Тип("КнопкаФормы"), ДляРяда);
	КнопкаРядФормы.Заголовок = Кнопка;
	КнопкаРядФормы.ИмяКоманды = "ОбычнаяКлавиша";
	КнопкаРядФормы.Ширина = 4; 	КнопкаРядФормы.Высота = 2;
	
	Возврат КнопкаРядФормы;
КонецФункции

Функция ДобавитьСлужебнуюКнопку(Знач ЭлементыФормы, Знач  ДляРяда, Знач Кнопка)
	Если Кнопка = "SHIFT" Тогда
		КнопкаРядФормы = ЭлементыФормы.Добавить(Кнопка + "_" + ДляРяда.Имя , Тип("КнопкаФормы"), ДляРяда);
		КнопкаРядФормы.Заголовок = Кнопка;
		КнопкаРядФормы.ИмяКоманды = "СпециальнаяКлавиша";
		КнопкаРядФормы.ЦветФона = WebЦвета.СветлоГрифельноСерый;
	ИначеЕсли Кнопка = "SPACE" Тогда
		КнопкаРядФормы = ЭлементыФормы.Добавить(Кнопка + "_" + ДляРяда.Имя , Тип("КнопкаФормы"), ДляРяда);
		КнопкаРядФормы.Заголовок = "Пробел";
		КнопкаРядФормы.ИмяКоманды = "СпециальнаяКлавиша";
		КнопкаРядФормы.ЦветФона = WebЦвета.СветлоЗеленый;
		КнопкаРядФормы.Ширина = 20;
	ИначеЕсли Кнопка = "LONG_TAB" Тогда 
		КнопкаРядФормы = ЭлементыФормы.Добавить(Кнопка + "_" + ДляРяда.Имя , Тип("ДекорацияФормы"), ДляРяда);
		КнопкаРядФормы.Вид = ВидДекорацииФормы.Надпись;
		КнопкаРядФормы.Заголовок = "";
		КнопкаРядФормы.Ширина = 16;
	ИначеЕсли Кнопка = "TAB" Тогда 
		КнопкаРядФормы = ЭлементыФормы.Добавить(Кнопка + "_" + ДляРяда.Имя , Тип("ДекорацияФормы"), ДляРяда);
		КнопкаРядФормы.Вид = ВидДекорацииФормы.Надпись;
		КнопкаРядФормы.Заголовок = "";
		КнопкаРядФормы.Ширина = 2;
	КонецЕсли;
	КнопкаРядФормы.Высота = 2;
  Возврат КнопкаРядФормы;
КонецФункции
```

Необходимо определить каким образом будет возвращаться нажатая клавиша.
